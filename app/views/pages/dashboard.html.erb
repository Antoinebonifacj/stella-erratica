<div class="container mt-5">
<h1>Tokotai <%= current_user.nickname %> !</h1>
  <% if current_user.traveller? %>
  <h2>My trips</h2>
  <% @bookings.each do |booking| %>
  <% unless booking.completed? %>
     <div class="trip-card">
         <div class="trip-notif">
           <% if current_user.avatar.attached? %>
             <%= cl_image_tag booking.planet.user.avatar.key, class: "avatar" %>
           <% else %>
             <%= image_tag "no-profile.png", class: "avatar" %>
           <% end %>
           <p>Request sent to <%= booking.planet.user.first_name %></p>
         </div>
         <div class="trip-details">
             <%= cl_image_tag booking.planet.photos.first.key %>
           <div class="trip-info">
             <div class="trip-header">
               <h2><%= booking.planet.name %></h2>
               <p>Long: <%= booking.planet.longitude %> Lat: <%= booking.planet.latitude %></p>
             </div>
             <div class="trip-booking-info">
               <div class="trip-icons">
                 <i class="fab fa-reddit-alien"></i> <span> <%= booking.planet.capacity %></span>
                 <i class="<%= booking.planet.environment.icon %>"></i>
               </div>
               <div class="trip-price">
                 <p>Total</p>
                 <p><%= booking.cost %></p>
               </div>
             </div>
             <% unless booking.approved? %>
             <div class="trip-footer">
               <p> <strong>Status:</strong> pending...</p>
             </div>
             <% end %>
           </div>
         </div>
     </div>
   <% end %>
   <% end %>
  <h2>Keep exploring</h2>
  <div class="planet-grid">
    <% @planets.take(2).each do |planet| %>
      <%= link_to planet_path(planet) do %>
       <div class="card-planet">
          <%= cl_image_tag planet.photos.first.key, height: 300, width: 400, crop: :fill %>
          <div class="card-planet-infos">
            <div class="card-planet-infos-text">
              <h2> <%= planet.name %></h2>
              <p><%= planet.longitude %> <%= planet.latitude %></p>
              <div class="card-planet-infos-icons">
                <i class="fab fa-reddit-alien"></i><span><%= planet.capacity %></span>
                <% planet.environments.each do |env| %>
                  <i class="<%= env.icon %>"></i>
                <% end %>
              </div>
            </div>
            <div class="card-planet-infos-price">
              <p>Rate:</p>
              <div class="card-planet-pricing">
                <p><%= planet.rate %></p>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>


  <% end %>

  <% if current_user.overlord? %>
    <h2>Requests</h2>
  <% @bookings.each do |booking| %>
    <% unless booking.completed? %>
       <div class="trip-card">
          <div class="trip-notif">
             <% if booking.user.avatar.attached? %>
               <%= cl_image_tag booking.user.avatar.key, class: "avatar" %>
             <% else %>
               <%= image_tag "no-profile.png", class: "avatar" %>
             <% end %>
             <p><%= booking.user.first_name %> sent you a request</p>
          </div>
          <div class="trip-details">
            
              <%= cl_image_tag booking.planet.photos.first.key %>
            <div class="trip-info">
              <div class="trip-header">
                <h2><%= booking.planet.name %></h2>
                <p>Long: <%= booking.planet.longitude %> Lat: <%= booking.planet.latitude %></p>
              </div>
              <div class="trip-booking-info">
                <div class="trip-icons">
                  <i class="fab fa-reddit-alien"></i> <span> <%= booking.planet.capacity %></span>
                  <% planet.environments.each do |env| %>
                    <i class="<%= env.icon %>"></i>
                  <% end %>
                </div>
                <div class="trip-price">
                  <p>Total</p>
                  <p><%= booking.cost %></p>
                </div>
              </div>
              <% unless booking.approved? %>
              <div class="trip-footer">
                <p> <strong>Status:</strong> pending...</p>
              </div>
              <% end %>
            </div>
            <div class="trip-booking-info">
                 <div class="trip-icons">
                   <i class="fab fa-reddit-alien"></i> <span> <%= booking.planet.capacity %></span>
                   <% planet.environments.each do |env| %>
                    <i class="<%= env.icon %>"></i>
                   <% end %>
                 </div>
                 <div class="trip-price">
                   <p>Total</p>
                   <p><%= booking.cost %></p>
                 </div>
             </div>
           </div>
        </div>
      <% unless booking.approved? %>
        <div class="request-status">
         <%= link_to approve_booking_path(booking),method: :patch, class: "btn-approve" do %>
         <i class="far fa-check-circle"></i> Accept
         <% end %>
         <%= link_to reject_booking_path(booking),method: :patch, class: "btn-reject" do%>
         <i class="fas fa-times"></i> Reject
         <% end %>
        </div>
      <% end %>
     <% end %>
    </div>
  <% end %>

    <h2>My planets</h2>
    <div class="my-planet-grid">
      <% current_user.planets.each do |planet| %>
        <div class="my-planet-card">
          <%= cl_image_tag planet.photos.first.key, height: 300, width: 400, crop: :fill %>
          <%= link_to "Terraform planet", edit_planet_path(planet) %>
          <div class="my-planet-infos">
            <div>
              <h2><%= planet.name %></h2>
              <p><%= planet.longitude %> <%= planet.latitude %></p>
              <div class="my-planet-icons">
                <p><i class="fab fa-reddit-alien"></i><%= planet.capacity %></p>
                <% planet.environments.each do |env| %>
                  <p><i class="<%= env.icon %>"></i></p>
                <% end %>
              </div>
            </div>
            <span><p>Rate:</p><h2 class="my-planet-pricing"> <%= planet.rate %></h2></span>
          </div>
        </div>
      <% end %>
    </div>

  <% end %>













</div>


